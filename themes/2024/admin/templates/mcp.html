<div class="mcp-management">
    <!-- MCP管理头部 -->
    <div class="page-header">
        <div class="header-left">
            <h2>MCP 服务器管理</h2>
            <p>管理 Model Context Protocol 服务器连接，支持多种AI模型和工具集成</p>
        </div>
        <div class="header-right">
            <button id="refresh-mcp-servers-btn" class="btn btn-secondary">
                <i class="icon-refresh"></i> 刷新状态
            </button>
            <button id="add-mcp-server-btn" class="btn btn-primary">
                <i class="icon-plus"></i> 添加服务器
            </button>
        </div>
    </div>

    <!-- MCP介绍 -->
    <div class="intro-section">
        <div class="intro-card">
            <div class="intro-icon">🔌</div>
            <div class="intro-content">
                <h3>什么是 MCP？</h3>
                <p>Model Context Protocol (MCP) 是一个标准化的协议，用于连接AI模型与各种工具和数据源。通过MCP服务器，您可以扩展FileCodeBox的功能，集成外部API、数据库、文件处理工具等。</p>
            </div>
        </div>
    </div>

    <!-- MCP服务器列表 -->
    <div class="servers-section">
        <div class="section-header">
            <h3>MCP 服务器列表</h3>
            <div class="server-stats">
                <span class="stat-item">
                    <span class="stat-label">总数:</span>
                    <span class="stat-value" id="total-servers">0</span>
                </span>
                <span class="stat-item">
                    <span class="stat-label">在线:</span>
                    <span class="stat-value" id="online-servers">0</span>
                </span>
                <span class="stat-item">
                    <span class="stat-label">离线:</span>
                    <span class="stat-value" id="offline-servers">0</span>
                </span>
            </div>
        </div>
        
        <div id="mcp-servers-container" class="servers-container">
            <!-- MCP服务器卡片将由JavaScript动态填充 -->
        </div>
    </div>

    <!-- 快速连接模板 -->
    <div class="templates-section">
        <div class="section-header">
            <h3>快速连接模板</h3>
            <p>使用预配置的模板快速连接常用的MCP服务器</p>
        </div>
        
        <div class="templates-grid">
            <div class="template-card">
                <div class="template-icon">🗄️</div>
                <div class="template-content">
                    <h4>数据库连接器</h4>
                    <p>连接MySQL、PostgreSQL、SQLite等数据库</p>
                    <div class="template-features">
                        <span class="feature-tag">SQL查询</span>
                        <span class="feature-tag">数据导出</span>
                        <span class="feature-tag">表管理</span>
                    </div>
                </div>
                <button class="btn btn-sm btn-secondary" data-template="database">使用模板</button>
            </div>
            
            <div class="template-card">
                <div class="template-icon">🌐</div>
                <div class="template-content">
                    <h4>Web API 连接器</h4>
                    <p>连接REST API、GraphQL等Web服务</p>
                    <div class="template-features">
                        <span class="feature-tag">HTTP请求</span>
                        <span class="feature-tag">JSON处理</span>
                        <span class="feature-tag">认证支持</span>
                    </div>
                </div>
                <button class="btn btn-sm btn-secondary" data-template="webapi">使用模板</button>
            </div>
            
            <div class="template-card">
                <div class="template-icon">📁</div>
                <div class="template-content">
                    <h4>文件处理器</h4>
                    <p>文件格式转换、图片处理、文档解析</p>
                    <div class="template-features">
                        <span class="feature-tag">格式转换</span>
                        <span class="feature-tag">图片处理</span>
                        <span class="feature-tag">文档解析</span>
                    </div>
                </div>
                <button class="btn btn-sm btn-secondary" data-template="fileprocessor">使用模板</button>
            </div>
            
            <div class="template-card">
                <div class="template-icon">🤖</div>
                <div class="template-content">
                    <h4>AI 工具集</h4>
                    <p>集成各种AI服务和机器学习工具</p>
                    <div class="template-features">
                        <span class="feature-tag">文本分析</span>
                        <span class="feature-tag">图像识别</span>
                        <span class="feature-tag">语音处理</span>
                    </div>
                </div>
                <button class="btn btn-sm btn-secondary" data-template="aitools">使用模板</button>
            </div>
        </div>
    </div>

    <!-- MCP文档链接 -->
    <div class="docs-section">
        <div class="docs-card">
            <div class="docs-icon">📚</div>
            <div class="docs-content">
                <h3>MCP 开发文档</h3>
                <p>了解如何创建自定义MCP服务器和扩展FileCodeBox功能</p>
                <div class="docs-links">
                    <a href="#" class="docs-link">MCP 协议规范</a>
                    <a href="#" class="docs-link">开发指南</a>
                    <a href="#" class="docs-link">示例代码</a>
                    <a href="#" class="docs-link">社区插件</a>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- MCP服务器编辑模态框 -->
<div id="mcp-server-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="mcp-server-modal-title">添加MCP服务器</h3>
            <button class="modal-close mcp-modal-close">&times;</button>
        </div>
        
        <div class="modal-body">
            <form class="form-grid">
                <div class="form-group">
                    <label for="mcp-server-name">服务器名称 *</label>
                    <input type="text" id="mcp-server-name" class="form-input" required>
                    <div class="field-help">给服务器一个易于识别的名称</div>
                </div>
                
                <div class="form-group">
                    <label for="mcp-server-host">服务器地址 *</label>
                    <input type="text" id="mcp-server-host" class="form-input" placeholder="localhost" required>
                    <div class="field-help">服务器的IP地址或域名</div>
                </div>
                
                <div class="form-group">
                    <label for="mcp-server-port">端口号 *</label>
                    <input type="number" id="mcp-server-port" class="form-input" placeholder="3000" min="1" max="65535" required>
                    <div class="field-help">MCP服务器监听的端口号</div>
                </div>
                
                <div class="form-group">
                    <label for="mcp-server-protocol">协议类型</label>
                    <select id="mcp-server-protocol" class="form-select">
                        <option value="stdio">STDIO</option>
                        <option value="http">HTTP</option>
                        <option value="websocket">WebSocket</option>
                        <option value="tcp">TCP</option>
                    </select>
                    <div class="field-help">MCP服务器使用的通信协议</div>
                </div>
                
                <div class="form-group full-width">
                    <label for="mcp-server-description">描述</label>
                    <textarea id="mcp-server-description" class="form-textarea" rows="3" placeholder="描述服务器的功能和用途..."></textarea>
                </div>
                
                <div class="form-group">
                    <div class="checkbox-group">
                        <input type="checkbox" id="mcp-server-enabled" class="checkbox" checked>
                        <label for="mcp-server-enabled">启用服务器</label>
                    </div>
                </div>
            </form>
        </div>
        
        <div class="modal-footer">
            <button class="btn btn-secondary mcp-modal-close">取消</button>
            <button id="save-mcp-server-btn" class="btn btn-primary">添加服务器</button>
        </div>
    </div>
</div>

<!-- 删除确认模态框 -->
<div id="delete-mcp-server-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>确认删除</h3>
            <button class="modal-close mcp-modal-close">&times;</button>
        </div>
        
        <div class="modal-body">
            <div class="warning-content">
                <div class="warning-icon">⚠️</div>
                <div class="warning-text">
                    <p>确定要删除MCP服务器 <strong id="delete-mcp-server-name"></strong> 吗？</p>
                    <p class="text-danger">此操作不可撤销，服务器的所有配置和连接历史将被删除。</p>
                </div>
            </div>
        </div>
        
        <div class="modal-footer">
            <button class="btn btn-secondary mcp-modal-close">取消</button>
            <button id="confirm-delete-mcp-server-btn" class="btn btn-danger">确认删除</button>
        </div>
    </div>
</div>

<style>
/* MCP管理特定样式 */
.mcp-management {
    padding: 20px;
}

.intro-section {
    margin-bottom: 30px;
}

.intro-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 12px;
    padding: 24px;
    display: flex;
    align-items: center;
    gap: 20px;
}

.intro-icon {
    font-size: 48px;
    opacity: 0.9;
}

.intro-content h3 {
    margin: 0 0 12px 0;
    font-size: 20px;
}

.intro-content p {
    margin: 0;
    opacity: 0.9;
    line-height: 1.6;
}

.server-stats {
    display: flex;
    gap: 20px;
    align-items: center;
}

.stat-item {
    display: flex;
    align-items: center;
    gap: 4px;
}

.stat-label {
    color: #6b7280;
    font-size: 14px;
}

.stat-value {
    font-weight: 600;
    color: #1f2937;
}

.servers-container {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.mcp-server-card {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    padding: 20px;
    border-left: 4px solid #10b981;
    transition: all 0.2s ease;
}

.mcp-server-card:hover {
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    transform: translateY(-1px);
}

.mcp-server-card.disabled {
    border-left-color: #9ca3af;
    opacity: 0.7;
}

.server-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 15px;
}

.server-info h3.server-name {
    margin: 0 0 4px 0;
    color: #1f2937;
    font-size: 18px;
}

.server-endpoint {
    color: #6b7280;
    font-size: 14px;
    font-family: monospace;
}

.server-details {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-bottom: 15px;
}

.detail-item {
    display: flex;
    justify-content: space-between;
    font-size: 14px;
}

.detail-label {
    color: #6b7280;
}

.detail-value {
    color: #1f2937;
    font-weight: 500;
}

.server-description {
    color: #6b7280;
    font-size: 14px;
    line-height: 1.5;
    margin-bottom: 15px;
    min-height: 20px;
}

.server-actions {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
}

.templates-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
    margin-top: 20px;
}

.template-card {
    background: white;
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    padding: 20px;
    transition: all 0.2s ease;
}

.template-card:hover {
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    transform: translateY(-1px);
}

.template-icon {
    font-size: 32px;
    margin-bottom: 12px;
}

.template-content h4 {
    margin: 0 0 8px 0;
    color: #1f2937;
}

.template-content p {
    margin: 0 0 12px 0;
    color: #6b7280;
    font-size: 14px;
    line-height: 1.5;
}

.template-features {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-bottom: 15px;
}

.feature-tag {
    background: #f3f4f6;
    color: #374151;
    padding: 4px 8px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 500;
}

.docs-section {
    margin-top: 40px;
}

.docs-card {
    background: #f8fafc;
    border: 2px dashed #cbd5e1;
    border-radius: 12px;
    padding: 24px;
    text-align: center;
}

.docs-icon {
    font-size: 48px;
    margin-bottom: 16px;
}

.docs-content h3 {
    margin: 0 0 12px 0;
    color: #1f2937;
}

.docs-content p {
    margin: 0 0 20px 0;
    color: #6b7280;
}

.docs-links {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    gap: 16px;
}

.docs-link {
    color: #3b82f6;
    text-decoration: none;
    font-weight: 500;
    padding: 8px 16px;
    border-radius: 6px;
    transition: background-color 0.2s ease;
}

.docs-link:hover {
    background-color: #dbeafe;
}

.empty-state {
    text-align: center;
    padding: 60px 20px;
    color: #6b7280;
}

.empty-icon {
    font-size: 64px;
    margin-bottom: 16px;
}

.empty-state h3 {
    margin: 0 0 8px 0;
    color: #374151;
}

.empty-state p {
    margin: 0;
}

.full-width {
    grid-column: 1 / -1;
}

/* 状态样式 */
.status-badge.status-success {
    background-color: #dcfce7;
    color: #166534;
}

.status-badge.status-error {
    background-color: #fee2e2;
    color: #dc2626;
}

.status-badge.status-warning {
    background-color: #fef3c7;
    color: #d97706;
}

.status-badge.status-secondary {
    background-color: #f3f4f6;
    color: #6b7280;
}
</style>
