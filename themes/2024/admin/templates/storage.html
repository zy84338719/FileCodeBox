<div class="storage-management">
    <!-- å­˜å‚¨ç®¡ç†å¤´éƒ¨ -->
    <div class="page-header">
        <div class="header-left">
            <h2>å­˜å‚¨ç®¡ç†</h2>
            <p>é…ç½®å’Œç®¡ç†æ–‡ä»¶å­˜å‚¨åç«¯ï¼Œæ”¯æŒæœ¬åœ°å­˜å‚¨ã€S3ã€WebDAVã€FTPç­‰</p>
        </div>
        <div class="header-right">
            <button id="refresh-stats-btn" class="btn btn-secondary">
                <i class="icon-refresh"></i> åˆ·æ–°ç»Ÿè®¡
            </button>
        </div>
    </div>

    <!-- å­˜å‚¨ç»Ÿè®¡ -->
    <div class="stats-section">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">ğŸ“</div>
                <div class="stat-content">
                    <div class="stat-label">æ€»æ–‡ä»¶æ•°</div>
                    <div class="stat-value" id="total-files">0</div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">ğŸ’¾</div>
                <div class="stat-content">
                    <div class="stat-label">æ€»å­˜å‚¨å¤§å°</div>
                    <div class="stat-value" id="total-size">0 B</div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">ğŸ“Š</div>
                <div class="stat-content">
                    <div class="stat-label">å·²ç”¨ç©ºé—´</div>
                    <div class="stat-value" id="used-space">0 B</div>
                </div>
            </div>
            
            <div class="stat-card">
                <div class="stat-icon">ğŸ”‹</div>
                <div class="stat-content">
                    <div class="stat-label">å¯ç”¨ç©ºé—´</div>
                    <div class="stat-value" id="available-space">æ— é™åˆ¶</div>
                </div>
            </div>
        </div>
        
        <!-- å­˜å‚¨ä½¿ç”¨ç‡ -->
        <div class="usage-section">
            <div class="usage-header">
                <h3>å­˜å‚¨ä½¿ç”¨ç‡</h3>
                <span id="storage-usage-percent">0%</span>
            </div>
            <div class="progress-bar-container">
                <div id="storage-usage-bar" class="progress-bar progress-success" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <!-- å­˜å‚¨é…ç½® -->
    <div class="config-section">
        <div class="section-header">
            <h3>å­˜å‚¨é…ç½®</h3>
            <div class="section-actions">
                <button id="test-connection-btn" class="btn btn-secondary">æµ‹è¯•è¿æ¥</button>
                <button id="save-storage-config-btn" class="btn btn-primary">ä¿å­˜é…ç½®</button>
            </div>
        </div>
        
        <div class="config-form">
            <!-- å­˜å‚¨ç±»å‹é€‰æ‹© -->
            <div class="form-group">
                <label for="storage-type">å­˜å‚¨ç±»å‹</label>
                <select id="storage-type" class="form-select">
                    <option value="local">æœ¬åœ°å­˜å‚¨</option>
                    <option value="s3">S3 å…¼å®¹å­˜å‚¨</option>
                    <option value="webdav">WebDAV å­˜å‚¨</option>
                    <option value="ftp">FTP å­˜å‚¨</option>
                </select>
                <div id="storage-help" class="field-help">
                    æœ¬åœ°å­˜å‚¨ï¼šæ–‡ä»¶ä¿å­˜åœ¨æœåŠ¡å™¨æœ¬åœ°ç£ç›˜ï¼Œç®€å•å¯é ä½†ä¸æ”¯æŒåˆ†å¸ƒå¼éƒ¨ç½²ã€‚
                </div>
            </div>

            <!-- æœ¬åœ°å­˜å‚¨é…ç½® -->
            <div id="local-config" class="storage-config-panel">
                <h4>æœ¬åœ°å­˜å‚¨é…ç½®</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="local-path">å­˜å‚¨è·¯å¾„</label>
                        <input type="text" id="local-path" class="form-input" placeholder="./data">
                        <div class="field-help">æ–‡ä»¶å­˜å‚¨çš„æœ¬åœ°ç›®å½•è·¯å¾„</div>
                    </div>
                    
                    <div class="form-group">
                        <label for="local-max-size">æœ€å¤§å­˜å‚¨å¤§å° (MB)</label>
                        <input type="number" id="local-max-size" class="form-input" placeholder="0">
                        <div class="field-help">0è¡¨ç¤ºæ— é™åˆ¶</div>
                    </div>
                </div>
            </div>

            <!-- S3å­˜å‚¨é…ç½® -->
            <div id="s3-config" class="storage-config-panel" style="display: none;">
                <h4>S3 å…¼å®¹å­˜å‚¨é…ç½®</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="s3-endpoint">ç«¯ç‚¹åœ°å€ *</label>
                        <input type="text" id="s3-endpoint" class="form-input" placeholder="https://s3.amazonaws.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="s3-region">åŒºåŸŸ</label>
                        <input type="text" id="s3-region" class="form-input" placeholder="us-east-1">
                    </div>
                    
                    <div class="form-group">
                        <label for="s3-access-key">Access Key *</label>
                        <input type="text" id="s3-access-key" class="form-input" placeholder="">
                    </div>
                    
                    <div class="form-group">
                        <label for="s3-secret-key">Secret Key *</label>
                        <input type="password" id="s3-secret-key" class="form-input" placeholder="">
                    </div>
                    
                    <div class="form-group">
                        <label for="s3-bucket">å­˜å‚¨æ¡¶åç§° *</label>
                        <input type="text" id="s3-bucket" class="form-input" placeholder="my-bucket">
                    </div>
                    
                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="s3-path-style" class="checkbox">
                            <label for="s3-path-style">ä½¿ç”¨è·¯å¾„æ ·å¼è®¿é—®</label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="s3-ssl" class="checkbox" checked>
                            <label for="s3-ssl">å¯ç”¨ SSL</label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- WebDAVå­˜å‚¨é…ç½® -->
            <div id="webdav-config" class="storage-config-panel" style="display: none;">
                <h4>WebDAV å­˜å‚¨é…ç½®</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="webdav-url">WebDAV URL *</label>
                        <input type="text" id="webdav-url" class="form-input" placeholder="https://your-webdav-server.com/dav">
                    </div>
                    
                    <div class="form-group">
                        <label for="webdav-username">ç”¨æˆ·å *</label>
                        <input type="text" id="webdav-username" class="form-input" placeholder="">
                    </div>
                    
                    <div class="form-group">
                        <label for="webdav-password">å¯†ç  *</label>
                        <input type="password" id="webdav-password" class="form-input" placeholder="">
                    </div>
                    
                    <div class="form-group">
                        <label for="webdav-path">å­˜å‚¨è·¯å¾„</label>
                        <input type="text" id="webdav-path" class="form-input" placeholder="/" value="/">
                    </div>
                    
                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="webdav-ssl" class="checkbox" checked>
                            <label for="webdav-ssl">éªŒè¯ SSL è¯ä¹¦</label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FTPå­˜å‚¨é…ç½® -->
            <div id="ftp-config" class="storage-config-panel" style="display: none;">
                <h4>FTP å­˜å‚¨é…ç½®</h4>
                <div class="form-grid">
                    <div class="form-group">
                        <label for="ftp-host">FTP ä¸»æœº *</label>
                        <input type="text" id="ftp-host" class="form-input" placeholder="ftp.example.com">
                    </div>
                    
                    <div class="form-group">
                        <label for="ftp-port">ç«¯å£</label>
                        <input type="number" id="ftp-port" class="form-input" placeholder="21" value="21">
                    </div>
                    
                    <div class="form-group">
                        <label for="ftp-username">ç”¨æˆ·å *</label>
                        <input type="text" id="ftp-username" class="form-input" placeholder="">
                    </div>
                    
                    <div class="form-group">
                        <label for="ftp-password">å¯†ç  *</label>
                        <input type="password" id="ftp-password" class="form-input" placeholder="">
                    </div>
                    
                    <div class="form-group">
                        <label for="ftp-path">å­˜å‚¨è·¯å¾„</label>
                        <input type="text" id="ftp-path" class="form-input" placeholder="/" value="/">
                    </div>
                    
                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="ftp-passive" class="checkbox" checked>
                            <label for="ftp-passive">è¢«åŠ¨æ¨¡å¼</label>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <div class="checkbox-group">
                            <input type="checkbox" id="ftp-ssl" class="checkbox">
                            <label for="ftp-ssl">å¯ç”¨ FTPS</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- å­˜å‚¨æ“ä½œ -->
    <div class="operations-section">
        <div class="section-header">
            <h3>å­˜å‚¨æ“ä½œ</h3>
        </div>
        
        <div class="operations-grid">
            <div class="operation-card">
                <div class="operation-icon">ğŸ§¹</div>
                <div class="operation-content">
                    <h4>æ¸…ç†å­˜å‚¨</h4>
                    <p>æ¸…ç†è¿‡æœŸæ–‡ä»¶å’Œä¸´æ—¶æ•°æ®</p>
                    <button id="cleanup-storage-btn" class="btn btn-warning">å¼€å§‹æ¸…ç†</button>
                </div>
            </div>
            
            <div class="operation-card">
                <div class="operation-icon">ğŸ”„</div>
                <div class="operation-content">
                    <h4>å­˜å‚¨è¿ç§»</h4>
                    <p>åœ¨ä¸åŒå­˜å‚¨åç«¯é—´è¿ç§»æ–‡ä»¶</p>
                    <button id="migrate-storage-btn" class="btn btn-primary">å¼€å§‹è¿ç§»</button>
                </div>
            </div>
        </div>
    </div>

    <!-- å­˜å‚¨åˆ†å¸ƒ -->
    <div class="distribution-section">
        <div class="section-header">
            <h3>å­˜å‚¨ç±»å‹åˆ†å¸ƒ</h3>
        </div>
        <div id="storage-distribution" class="distribution-container">
            <!-- åˆ†å¸ƒæ•°æ®å°†ç”±JavaScriptåŠ¨æ€å¡«å…… -->
        </div>
    </div>
</div>

<!-- æ¸…ç†ç¡®è®¤æ¨¡æ€æ¡† -->
<div id="cleanup-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>å­˜å‚¨æ¸…ç†</h3>
            <button class="modal-close storage-modal-close">&times;</button>
        </div>
        
        <div class="modal-body">
            <div class="form">
                <div class="form-group">
                    <label>æ¸…ç†ç±»å‹</label>
                    <div class="radio-group">
                        <label class="radio-label">
                            <input type="radio" name="cleanup-type" value="expired" checked>
                            <span>ä»…æ¸…ç†è¿‡æœŸæ–‡ä»¶</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="cleanup-type" value="temp">
                            <span>æ¸…ç†ä¸´æ—¶æ–‡ä»¶</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="cleanup-type" value="all">
                            <span>æ¸…ç†æ‰€æœ‰å¯æ¸…ç†æ–‡ä»¶</span>
                        </label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="cleanup-days">æ¸…ç†å¤šå°‘å¤©å‰çš„æ–‡ä»¶</label>
                    <input type="number" id="cleanup-days" class="form-input" value="30" min="1">
                </div>
            </div>
        </div>
        
        <div class="modal-footer">
            <button class="btn btn-secondary storage-modal-close">å–æ¶ˆ</button>
            <button id="confirm-cleanup-btn" class="btn btn-warning">ç¡®è®¤æ¸…ç†</button>
        </div>
    </div>
</div>

<!-- è¿ç§»æ¨¡æ€æ¡† -->
<div id="migrate-modal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h3>å­˜å‚¨è¿ç§»</h3>
            <button class="modal-close storage-modal-close">&times;</button>
        </div>
        
        <div class="modal-body">
            <div class="form">
                <div class="form-group">
                    <label for="migrate-from">æºå­˜å‚¨ç±»å‹</label>
                    <select id="migrate-from" class="form-select">
                        <!-- é€‰é¡¹å°†ç”±JavaScriptåŠ¨æ€å¡«å…… -->
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="migrate-to">ç›®æ ‡å­˜å‚¨ç±»å‹</label>
                    <select id="migrate-to" class="form-select">
                        <!-- é€‰é¡¹å°†ç”±JavaScriptåŠ¨æ€å¡«å…… -->
                    </select>
                </div>
                
                <div class="warning-content">
                    <div class="warning-icon">âš ï¸</div>
                    <div class="warning-text">
                        <p><strong>æ³¨æ„ï¼š</strong></p>
                        <ul>
                            <li>è¿ç§»è¿‡ç¨‹å¯èƒ½éœ€è¦è¾ƒé•¿æ—¶é—´</li>
                            <li>å»ºè®®åœ¨ä½å³°æœŸè¿›è¡Œè¿ç§»</li>
                            <li>è¿ç§»æœŸé—´è¯·å‹¿å…³é—­ç³»ç»Ÿ</li>
                            <li>å»ºè®®å…ˆå¤‡ä»½é‡è¦æ•°æ®</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="modal-footer">
            <button class="btn btn-secondary storage-modal-close">å–æ¶ˆ</button>
            <button id="start-migrate-btn" class="btn btn-primary">å¼€å§‹è¿ç§»</button>
        </div>
    </div>
</div>

<style>
/* å­˜å‚¨ç®¡ç†ç‰¹å®šæ ·å¼ */
.storage-management {
    padding: 20px;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
}

.stat-card {
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    display: flex;
    align-items: center;
    gap: 15px;
}

.stat-icon {
    font-size: 24px;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.stat-content {
    flex: 1;
}

.stat-label {
    font-size: 14px;
    color: #6b7280;
    margin-bottom: 4px;
}

.stat-value {
    font-size: 24px;
    font-weight: 600;
    color: #1f2937;
}

.usage-section {
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    margin-bottom: 30px;
}

.usage-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
}

.storage-config-panel {
    background: #f9fafb;
    border-radius: 8px;
    padding: 20px;
    margin-top: 20px;
}

.storage-config-panel h4 {
    margin: 0 0 20px 0;
    color: #1f2937;
}

.operations-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 20px;
}

.operation-card {
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    display: flex;
    align-items: flex-start;
    gap: 15px;
}

.operation-icon {
    font-size: 24px;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.operation-content {
    flex: 1;
}

.operation-content h4 {
    margin: 0 0 8px 0;
    color: #1f2937;
}

.operation-content p {
    margin: 0 0 15px 0;
    color: #6b7280;
    font-size: 14px;
}

.distribution-container {
    background: white;
    border-radius: 8px;
    padding: 20px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.storage-type-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 0;
    border-bottom: 1px solid #e5e7eb;
}

.storage-type-item:last-child {
    border-bottom: none;
}

.storage-type-name {
    font-weight: 500;
    color: #1f2937;
}

.storage-type-stats {
    display: flex;
    gap: 20px;
    color: #6b7280;
    font-size: 14px;
}

.storage-type-percent {
    font-weight: 500;
    color: #1f2937;
}

.radio-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.radio-label {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
}

.radio-label input[type="radio"] {
    margin: 0;
}
</style>
